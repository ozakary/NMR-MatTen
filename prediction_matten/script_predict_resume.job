#!/bin/bash -l

#--------------------------------------------------------------------------------------------------------------------------------
#SBATCH --partition=debug
#SBATCH --ntasks=40
#SBATCH --time=00:30:00
#SBATCH --account=project_462000738
#SBATCH --output=nmr-ml_matten-output_%j.txt
#SBATCH --error=nmr-ml_matten-errors_%j.txt
#SBATCH --get-user-env
#SBATCH --exclusive
#SBATCH --hint=nomultithread
#--------------------------------------------------------------------------------------------------------------------------------
#================================< Instructions-Section for Training Full Magnetic Shielding Tensor using SchNet Model >============================================
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------

module load cray-python

source /scratch/project_462000738/zakaryou/packages/matten_installation/matten_env/bin/activate

# Set unlimited stack size
ulimit -s unlimited


python3 predict_atomic_tensor.py nmr_Xe_CC3_TBA-traj.xyz output_prediction.csv \
  --save_every 1 \
  --resume \
  --model_path "/scratch/project_462000738/zakaryou/NMR-ML/MatTen/2xe_tba_cc3_high-th-level_3125_sanity-checked_dataset/training-puhti/matten_logs/matten_proj/ncsgsf99/checkpoints/" \
  --checkpoint "last.ckpt"
